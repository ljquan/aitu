# Update CLAUDE.md 命令使用说明

## 概述

`update-claude-md` 是一个 Claude Code 命令，用于智能更新 CLAUDE.md 文档。当项目中添加新功能、插件或组件时，使用此命令可以自动更新文档的相关章节。

## 使用方法

### 基本用法

在 Claude Code 中输入：

```
/update-claude-md
```

或者在对话中说明需要更新的内容：

```
我刚添加了一个新的文本粘贴插件，请使用 /update-claude-md 更新文档
```

### 适用场景

此命令适用于以下情况：

1. **添加新插件** (`packages/drawnix/src/plugins/`)
   - 自动更新插件列表
   - 更新插件流程图
   - 创建功能说明章节

2. **添加新组件** (`packages/drawnix/src/components/`)
   - 更新组件目录列表
   - 添加组件说明

3. **添加新 Hook** (`packages/drawnix/src/hooks/`)
   - 更新 Hooks 列表
   - 添加用途说明

4. **添加新工具函数** (`packages/drawnix/src/utils/`)
   - 更新工具函数列表
   - 分组相关工具

5. **添加新文档**
   - 更新"相关文档"章节
   - 添加文档链接

## 命令执行流程

1. **理解变更**
   - 识别添加/修改的内容
   - 确定影响范围

2. **读取 CLAUDE.md**
   - 理解文档结构
   - 确定需要更新的章节

3. **更新相关章节**
   - 插件列表
   - 组件列表
   - 功能流程图
   - 相关文档链接

4. **创建功能说明**（如果是重要功能）
   - 核心文件列表
   - 功能特点
   - 使用方法
   - 配置参数

5. **验证更新**
   - 检查交叉引用
   - 验证文件路径
   - 确保格式一致

## 文档更新模式

### 添加插件

**更新内容：**
- `plugins/` 目录列表
- 编辑器插件系统流程图
- 创建功能章节（如果是重要功能）
- 相关文档列表

**示例：**
```markdown
plugins/
├── with-text-paste.ts             # 文本粘贴插件（自动换行）
└── ...

### 文本粘贴功能

支持智能文本粘贴到画布...
```

### 添加组件

**更新内容：**
- 相应组件分类列表
- 文件路径和描述
- 创建子章节（如果是重要 UI 组件）

### 添加文档

**更新内容：**
- "相关文档"章节
- 格式：`- /path/to/doc.md - 简要描述`

## 文档风格指南

### 语言规范
- **描述文字**：使用中文
- **代码示例**：使用英文
- **文件路径**：使用相对路径

### 格式规范
- **代码块**：使用三个反引号 + 语言标识符
- **列表**：无序列表用 `-`，有序列表用数字
- **强调**：章节标题用 `**粗体**`，文件/函数名用 `code`

### 结构规范
- 遵循现有层级结构
- 保持一致的缩进和间距
- 维护逻辑或字母顺序

## 示例

### 示例 1：添加文本粘贴插件

**输入：**
```
我添加了 with-text-paste.ts 插件，请更新 CLAUDE.md
```

**执行结果：**
1. 在插件列表中添加 `with-text-paste.ts`
2. 更新插件流程图
3. 创建"文本粘贴功能"章节
4. 添加文档链接到相关文档列表

### 示例 2：添加新组件

**输入：**
```
我添加了 VideoFrameSelector 组件，请更新文档
```

**执行结果：**
1. 在组件列表中添加 `video-frame-selector/`
2. 添加组件描述

## 注意事项

1. **不要删除现有内容**
   - 除非明确要求，否则只添加不删除

2. **保持格式一致**
   - 遵循现有的文档风格
   - 使用相同的术语

3. **验证文件路径**
   - 确保所有路径正确
   - 使用相对路径

4. **简洁但完整**
   - 描述要简洁明了
   - 包含必要的信息

5. **检查交叉引用**
   - 确保链接正确
   - 避免重复条目

## 相关文件

- `.claude/commands/update-claude-md.md` - 命令定义文件
- `CLAUDE.md` - 项目主文档
- `docs/` - 详细文档目录

## 常见问题

**Q: 什么时候应该使用这个命令？**
A: 当你添加了新的插件、组件、Hook、工具函数或文档时。

**Q: 命令会自动创建详细文档吗？**
A: 不会，命令只更新 CLAUDE.md。详细文档需要单独创建。

**Q: 如何确保更新正确？**
A: 命令会读取现有文档结构，遵循相同的格式和风格。

**Q: 可以撤销更新吗？**
A: 可以使用 git 撤销更改：`git checkout CLAUDE.md`

## 最佳实践

1. **先创建详细文档**
   - 在 `docs/` 目录创建详细文档
   - 然后使用命令更新 CLAUDE.md

2. **提供清晰的上下文**
   - 说明添加了什么
   - 说明文件位置
   - 说明功能用途

3. **验证更新结果**
   - 检查更新的章节
   - 确认格式正确
   - 验证链接有效

4. **及时更新**
   - 添加功能后立即更新文档
   - 避免文档与代码不同步

## 总结

`update-claude-md` 命令简化了文档更新流程，确保 CLAUDE.md 始终反映项目的最新状态。通过自动化文档更新，可以节省时间并保持文档的一致性和准确性。
