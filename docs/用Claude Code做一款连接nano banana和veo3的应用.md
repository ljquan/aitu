# 用Claude Code构建AI创意工作流：连接nano banana与veo3

## 背景

近半年来，海外最火的三款应用：Claude Code（AI编程）、nano banana（AI图像生成）和veo3（AI视频生成）。如何一次过深入体验这三款产品，并创造出更强大的创意工作流呢？

通过深入思考，我发现了一个有趣的连接点：
- **无限画布** 是nano banana的理想应用场景，可以自由组合图片元素和手绘内容
- **AI生成的图片** 是veo3创作视频的优质素材 
- **视频帧提取** 又可以作为新的图片素材，形成创意循环

基于这个洞察，我决定用Claude Code开发一款应用，把nano banana与veo3无缝连接起来。

## 技术选型

选择[Drawnix](https://github.com/plait-board/drawnix)作为基础画布工具进行二次开发，理由如下：
- 开源且架构清晰，便于定制化开发
- 支持多种绘图元素和插件扩展
- 基于React生态，开发效率高

考虑到国内用户访问海外AI服务的技术门槛，本项目通过[兔子](https://tu-zi.com/)平台提供的实惠方案，兔子平台在AI社区也小有名气。

## 核心功能实现

### 功能一：智能图片组合生成
nano banana的一个杀手级功能是将多个人物图片与手绘姿势结合，生成符合创意需求的合成图片，并且生成的图片和输入图片有非常好的一致性。

**需求**:
1. 快速选择画板上的多个图片元素，显示AI 图片生成按钮，点击，自动填充到表单
2. 将画板中图文以外的所有元素（手绘线条、形状等）导出为图片，作为参考素材
3. 在弹窗上点生成按钮，调用tu-zi提供的API接口生成图片
4. 点击插入，把生成的图片插入到所有选中元素底部+50px像素的位置并垂直居中对齐

![选择元素](images/选择元素.png)
![自动填入表单](images/表单.png)
![生成](images/生成.png)

**开发过程**:
Claude Code快速完成了基础版本，但在"导出非图片元素"这个需求上遇到了挑战。来回调试了好几次，生成的图片都有问题，最后告诉它参考导出图片的逻辑实现。成功了！这是体验CC的aha时刻。之后零碎打磨增加了很多小特性：接口调用、异常处理、记录提示词、记录生成历史、生成图片插入的位置等等。前后花了2个多小时。

nano banana 体验：因为一致性很强，所以需要多个图片融合效果，最好只用人半身图，不含手脚，不然可能手脚不能很好按照手绘图的姿势摆。另外也要跟它强调，生成的图片不要包含手绘图的元素，不然可能生成的图片含手绘内容。

### 功能二：图片生成视频
veo3最让我惊艳的点是，音画同步，可以生成声音和口型一致，并且符合物理逻辑。
**需求**: 
1.选中图片，显示AI 视频生成按钮，点击，打开AI 视频生成弹窗，并自动填充到表单
2. 如果选中的图片上有图文之外的元素，则与图片一起合成一张图片填入表单
3. 在弹窗上点生成按钮，调用tu-zi提供的API接口生成视频
4. 点击插入，把生成的视频插入到所有选中元素底部+50px像素的位置并垂直居中对齐

![选择图片](images/选择图片.png)
![视频生成弹窗](images/视频生成弹窗.png)

### 功能三：选择视频帧
veo3只能生成8秒的视频，如果要生成连续的长视频，比较好的方式可能是取最后一帧图片，接着生成下一个视频。
**需求**: 
1.选中视频，显示视频帧选择按钮，点击，打开视频帧选择弹窗。
2.默认选择最后一帧图片显示在弹窗上方，下面可以拖动进度或者输入进准定位到对应时间的帧
3. 点击插入，把视频帧插入到视频元素底部+50px像素的位置并垂直居中对齐

![选择图片](images/选择图片.png)
![视频生成弹窗](images/视频生成弹窗.png)